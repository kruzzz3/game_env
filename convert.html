<html>
    <head>
        <title>Convert</title>
        <style>
        #output {
            width:100%;
            height:auto;
        }
        table {
           border-collapse: collapse;
        }
        table td{
            min-width:200px;
            border: solid 1px #000;
        }
        </style>

        <script>
        var inputFormProject = '{"rigidBodies":[{"name":"poly_star","imagePath":"poly_star.png","origin":{"x":0,"y":0},"polygons":[[{"x":0.39124998450279236,"y":0.6287499666213989},{"x":0.008749961853027344,"y":0.7087500095367432},{"x":0.29625001549720764,"y":0.42625001072883606}],[{"x":0.29625001549720764,"y":0.42625001072883606},{"x":0.10999999940395355,"y":0.10000002384185791},{"x":0.45875000953674316,"y":0.2762500047683716}],[{"x":0.45875000953674316,"y":0.2762500047683716},{"x":0.7099999785423279,"y":0.019999980926513672},{"x":0.653749942779541,"y":0.3812499940395355}],[{"x":0.653749942779541,"y":0.3812499940395355},{"x":0.9900000095367432,"y":0.550000011920929},{"x":0.6212499737739563,"y":0.6012499928474426}],[{"x":0.6212499737739563,"y":0.6012499928474426},{"x":0.5687500238418579,"y":0.9887500405311584},{"x":0.39124998450279236,"y":0.6287499666213989}],[{"x":0.39124998450279236,"y":0.6287499666213989},{"x":0.29625001549720764,"y":0.42625001072883606},{"x":0.45875000953674316,"y":0.2762500047683716},{"x":0.653749942779541,"y":0.3812499940395355},{"x":0.6212499737739563,"y":0.6012499928474426}]],"circles":[],"shapes":[{"type":"POLYGON","vertices":[{"x":0.5687500238418579,"y":0.9887500405311584},{"x":0.6212499737739563,"y":0.6012499928474426},{"x":0.9900000095367432,"y":0.550000011920929},{"x":0.653749942779541,"y":0.3812499940395355},{"x":0.7099999785423279,"y":0.019999980926513672},{"x":0.45875000953674316,"y":0.2762500047683716},{"x":0.10999999940395355,"y":0.10000002384185791},{"x":0.29625001549720764,"y":0.42625001072883606},{"x":0.008749961853027344,"y":0.7087500095367432},{"x":0.39124998450279236,"y":0.6287499666213989}]}]},{"name":"poly_stairs","imagePath":"poly_stairs.png","origin":{"x":0,"y":0},"polygons":[[{"x":0.2487499713897705,"y":0.49125000834465027},{"x":-0.0012500286102294922,"y":0.48875001072883606},{"x":0.0012499690055847168,"y":0.0062499940395355225},{"x":0.49125003814697266,"y":0.0037499964237213135},{"x":0.48874998092651367,"y":0.2512499690055847}],[{"x":0.48874998092651367,"y":0.2512499690055847},{"x":0.7387499809265137,"y":0.2512499690055847},{"x":0.7387499809265137,"y":0.5087500214576721},{"x":0.5062500238418579,"y":0.7437500357627869},{"x":0.2487499713897705,"y":0.7412499785423279},{"x":0.2487499713897705,"y":0.49125000834465027}],[{"x":0.7387499809265137,"y":0.5087500214576721},{"x":1.0012500286102295,"y":0.5087500214576721},{"x":1.0012500286102295,"y":1.0012500286102295},{"x":0.5099999904632568,"y":1},{"x":0.5062500238418579,"y":0.7437500357627869}]],"circles":[],"shapes":[{"type":"POLYGON","vertices":[{"x":0.5099999904632568,"y":1},{"x":1.0012500286102295,"y":1.0012500286102295},{"x":1.0012500286102295,"y":0.5087500214576721},{"x":0.7387499809265137,"y":0.5087500214576721},{"x":0.7387499809265137,"y":0.2512499690055847},{"x":0.48874998092651367,"y":0.2512499690055847},{"x":0.49125003814697266,"y":0.0037499964237213135},{"x":0.0012499690055847168,"y":0.0062499940395355225},{"x":-0.0012500286102294922,"y":0.48875001072883606},{"x":0.2487499713897705,"y":0.49125000834465027},{"x":0.2487499713897705,"y":0.7412499785423279},{"x":0.5062500238418579,"y":0.7437500357627869}]}]},{"name":"poly_triangle","imagePath":"poly_triangle.png","origin":{"x":0,"y":0},"polygons":[[{"x":0.4962500035762787,"y":0.0037499964237213135},{"x":1.0037500858306885,"y":1.0012500286102295},{"x":0,"y":1}]],"circles":[],"shapes":[{"type":"POLYGON","vertices":[{"x":0,"y":1},{"x":1.0037500858306885,"y":1.0012500286102295},{"x":0.4962500035762787,"y":0.0037499964237213135}]}]},{"name":"poly_rocket","imagePath":"poly_rocket.png","origin":{"x":0,"y":0},"polygons":[[{"x":0.16856062412261963,"y":0.8465909361839294},{"x":0.0018939971923828125,"y":0.6534090638160706},{"x":0.01325756311416626,"y":0.48674243688583374},{"x":0.0892857164144516,"y":0.4107142686843872},{"x":0.24431824684143066,"y":0.5435606837272644}],[{"x":0.7556817531585693,"y":0.5549242496490479},{"x":0.9223483800888062,"y":0.3958333432674408},{"x":0.986742377281189,"y":0.4829545319080353},{"x":0.986742377281189,"y":0.6761363744735718},{"x":0.8276514410972595,"y":0.8390151262283325}],[{"x":0.8276514410972595,"y":0.8390151262283325},{"x":0.8200757503509521,"y":1.16856050491333},{"x":0.7767857313156128,"y":1.4285714626312256},{"x":0.6785714030265808,"y":1.6607142686843872},{"x":0.5357142686843872,"y":1.7857142686843872},{"x":0.4553571343421936,"y":1.7857142686843872},{"x":0.3392857015132904,"y":1.6964285373687744}],[{"x":0.3392857015132904,"y":1.6964285373687744},{"x":0.25,"y":1.5357142686843872},{"x":0.1696428507566452,"y":1.1785714626312256},{"x":0.16856062412261963,"y":0.8465909361839294},{"x":0.24431824684143066,"y":0.5435606837272644},{"x":0.497499942779541,"y":0.007499992847442627},{"x":0.7556817531585693,"y":0.5549242496490479},{"x":0.8276514410972595,"y":0.8390151262283325}]],"circles":[],"shapes":[{"type":"POLYGON","vertices":[{"x":0.4553571343421936,"y":1.7857142686843872},{"x":0.5357142686843872,"y":1.7857142686843872},{"x":0.6785714030265808,"y":1.6607142686843872},{"x":0.7767857313156128,"y":1.4285714626312256},{"x":0.8200757503509521,"y":1.16856050491333},{"x":0.8276514410972595,"y":0.8390151262283325},{"x":0.986742377281189,"y":0.6761363744735718},{"x":0.986742377281189,"y":0.4829545319080353},{"x":0.9223483800888062,"y":0.3958333432674408},{"x":0.7556817531585693,"y":0.5549242496490479},{"x":0.497499942779541,"y":0.007499992847442627},{"x":0.24431824684143066,"y":0.5435606837272644},{"x":0.0892857164144516,"y":0.4107142686843872},{"x":0.01325756311416626,"y":0.48674243688583374},{"x":0.0018939971923828125,"y":0.6534090638160706},{"x":0.16856062412261963,"y":0.8465909361839294},{"x":0.1696428507566452,"y":1.1785714626312256},{"x":0.25,"y":1.5357142686843872},{"x":0.3392857015132904,"y":1.6964285373687744}]}]},{"name":"poly_rocket2","imagePath":"poly_rocket2.png","origin":{"x":0,"y":0},"polygons":[[{"x":0.3112499713897705,"y":0.13875001668930054},{"x":0.22500000894069672,"y":0.05000000074505806},{"x":0.2787500023841858,"y":0.011249959468841553},{"x":0.3762500286102295,"y":0.011249959468841553},{"x":0.4650000035762787,"y":0.09999999403953552}],[{"x":0.4650000035762787,"y":0.09999999403953552},{"x":0.6862500309944153,"y":0.0987500250339508},{"x":0.9487500190734863,"y":0.1912499964237213},{"x":0.9987500309944153,"y":0.2762500047683716},{"x":0.9487500190734863,"y":0.3712500333786011},{"x":0.7037500143051147,"y":0.45375001430511475}],[{"x":0.7037500143051147,"y":0.45375001430511475},{"x":0.4650000035762787,"y":0.4650000035762787},{"x":0.3162499964237213,"y":0.42124998569488525},{"x":0.22500000894069672,"y":0.2750000059604645},{"x":0.3112499713897705,"y":0.13875001668930054},{"x":0.4650000035762787,"y":0.09999999403953552}],[{"x":0.4650000035762787,"y":0.4650000035762787},{"x":0.3712499737739563,"y":0.5562499761581421},{"x":0.2787500023841858,"y":0.5537499785423279},{"x":0.22500000894069672,"y":0.5250000357627869},{"x":0.3162499964237213,"y":0.42124998569488525}]],"circles":[],"shapes":[{"type":"POLYGON","vertices":[{"x":0.2787500023841858,"y":0.5537499785423279},{"x":0.3712499737739563,"y":0.5562499761581421},{"x":0.4650000035762787,"y":0.4650000035762787},{"x":0.7037500143051147,"y":0.45375001430511475},{"x":0.9487500190734863,"y":0.3712500333786011},{"x":0.9987500309944153,"y":0.2762500047683716},{"x":0.9487500190734863,"y":0.1912499964237213},{"x":0.6862500309944153,"y":0.0987500250339508},{"x":0.4650000035762787,"y":0.09999999403953552},{"x":0.3762500286102295,"y":0.011249959468841553},{"x":0.2787500023841858,"y":0.011249959468841553},{"x":0.22500000894069672,"y":0.05000000074505806},{"x":0.3112499713897705,"y":0.13875001668930054},{"x":0.22500000894069672,"y":0.2750000059604645},{"x":0.3162499964237213,"y":0.42124998569488525},{"x":0.22500000894069672,"y":0.5250000357627869}]}]}],"dynamicObjects":[]}';


            var response = "<table>";
            var title = new Array();
            var indexTitle = 0;
            function parseInit() {
                var parseString = inputFormProject;
                getNames(parseString);
                var objects = new Array();
                while (parseString.indexOf('"polygons":') >= 0){
                    var start = parseString.indexOf('"polygons":');
                    var end = parseString.indexOf(',"circles"') + 10;
                    var sub = parseString.substring(start, end);
                    parseString = parseString.replace(sub,"");
                    sub = sub.replace('"polygons":',"");
                    sub = sub.replace(',"circles"',"");
                    objects.push(sub);
                }
                for (var index = 0; index < objects.length; ++index) {
                    parseObject(objects[index]);
                }

                response += "</table>";
                document.getElementById("output").innerHTML = response;
            }

            function getNames(parseString) {
                var i = 1;
                while (xIndexOf('"name":', parseString, i) >= 0) {
                    var start = xIndexOf('"name":', parseString, i) + 8;
                    var end = xIndexOf('","imagePath', parseString, i);
                    var sub = parseString.substring(start, end);
                    title.push(sub);
                    i++;
                }
            }

            function parseObject(objectsArrayString) {
                if (objectsArrayString.length > 10) {
                    
                    objectsArrayString = objectsArrayString.replace('[[',"");
                    objectsArrayString = objectsArrayString.replace(']]',"");
                    var objectsArray = objectsArrayString.split("],[");
                    var answerString = "[";
                    for (var index = 0; index < objectsArray.length; ++index) {
                        var objects = objectsArray[index];

                        var i = 1;
                        var xValues = new Array();
                        var yValues = new Array();

                        var biggestFloat = 0;
                        while (xIndexOf('"x":', objects, i) >= 0) {
                            var start = xIndexOf('"x":', objects, i) + 4;
                            var end = xIndexOf(',"y":', objects, i);
                            var sub = objects.substring(start, end);
                            var cFloat = parseFloat(sub);
                            xValues.push(cFloat);
                            if (cFloat > biggestFloat) {
                                biggestFloat = cFloat;
                            }
                            
                            i++;
                        }
                        i = 1;
                        while (xIndexOf('"y":', objects, i) >= 0) {
                            var start = xIndexOf('"y":', objects, i) + 4;
                            var end = xIndexOf('}', objects, i);
                            var sub = objects.substring(start, end);
                            var cFloat = parseFloat(sub);
                            yValues.push(cFloat);
                            if (cFloat > biggestFloat) {
                                biggestFloat = cFloat;
                            }
                            
                            i++;
                        }

                        if (biggestFloat > 1) {
                            xValues = reScale(xValues, biggestFloat);
                            yValues = reScale(yValues, biggestFloat);
                        }

                        answerString += reFormat(xValues, yValues);

                        if ((index + 1) < objectsArray.length) {
                            answerString += ",";
                        }

                    }
                    answerString += "]";

                }
                if (answerString != undefined)
                {
                    response += "<tr>";
                        response += "<td>";
                            response += title[indexTitle];
                        response += "</td>";
                        response += "<td>";
                            response += answerString;
                        response += "</td>";
                    response += "</tr>";
                    indexTitle++;
                }
                else {
                    response += "<tr>";
                        response += "<td>";
                            response += title[indexTitle];
                        response += "</td>";
                        response += "<td>";
                            response += "ERROR";
                        response += "</td>";
                    response += "</tr>";
                    indexTitle++;
                }
            }

            function reScale(values, biggestFloat) {
                var scaleBy = 1 / biggestFloat;
                for (var index = 0; index < values.length; ++index) {
                    values[index] = values[index] * scaleBy;
                }
                return values;
            }

            function reFormat(xValues, yValues) {
                var answer = "[";
                for (var index = 0; index < xValues.length; ++index) {
                    answer += "{";
                    answer += '"x":';
                    answer += (xValues[index]).toFixed(6);
                    answer += ',"y":';
                    answer += (yValues[index]).toFixed(6);
                    answer += "}";
                    if ((index + 1) < xValues.length) {
                        answer += ",";
                    }
                }
                answer += "]";
                return answer;
            }



            function printObject(objects) {
                
            }

            function xIndexOf(Val, Str, x)  
            {  
                if (x <= (Str.split(Val).length - 1)) {  
                Ot = Str.indexOf(Val);  
                if (x > 1) { for (var i = 1; i < x; i++) { var Ot = Str.indexOf(Val, Ot + 1) } }  
                return Ot;  
                } else { return -1; }  
            } 

        </script>
    </head>
    <body onLoad="parseInit()">
        <div id="output"></div>
    </body>
</html>
